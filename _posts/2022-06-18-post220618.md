---
title: (Web) Web Server와 WAS
date: 2022-06-18 19:30 +0900
lastmod: 2022-06-18 19:30 +0900
categories: [Web]
tags: [Web]
mermaid: true
math: true
---

> 웹서버(Web Server), 어플리케이션 서버(Application Server) 혹은 웹 어플리케이션 서버(Web Application Server) 간 개념이 혼동되어 이 글을 작성한다.

![Untitled](/assets/img/2022-06-18-web220618/Untitled 1.png)

사용자는 서버로 요청을 보내고, 서버에서 이 요청에 대한 응답을 보낸다. 사용자가 정적인 페이지, 예를 들어 index.html을 요청한다면 이를 그대로 반환해주면 된다. 그런데 만약 요청이 동적인 경우라면 어떻게 할까? 로그인이나 회원가입 요청과 같이 그때그때 그 값이 달라지는 때에는 어떻게 처리해야 할까?

웹 어플리케이션이 서버에서 실행되어 어떤 동작(데이터베이스에 접근 등)을 처리하고 그에 맞는 html을 리턴해주면 될 것 같다. 이를 위해서는 결국 서버로 들어온 요청을 웹 어플리케이션으로 넘겨줄 수 있어야 한다. 


# Application Server
---

![Untitled](/assets/img/2022-06-18-web220618/Untitled 2.png)

먼저 Application Server란 위에 보이는 것 처럼 말그대로 서버 그자체를 나타낸다. 그림에서 보이는 것처럼, 네트워크가 연결되어있기만 하다면, 그 네트워크를 통해 서버와 Endpoint 간의 통신을 할 수 있는 Server 이다.

즉, HTTP 뿐 아니라 TCP, UDP 등 다양한 프로토콜을 전달받아 클라이언트에 다양한 서비스를 제공한다. 

당연히 복잡한 비즈니스 로직의 처리를 할 수 있으며 이에 따라 Client는 단순히 정보를 Display하는 것 이상의 동작이 자유롭다. Java 진영에서는 트랜잭션 처리, 보안 처리, 리소스 풀링, 메시징 등을 처리해주는 EJB, J2EE 등이 대표적이다. 

많은 Application Server는 단순히 Web page를 띄우는 이상을 처리한다.(DB와의 동적인 연동, 클러스터링, fail-over, 로드밸런싱 등) 대표적인 Java 진영의 예로는 레진서버, Spring framework, Expresso 등이 J2EE의 대표적인 Application Server Framework이다. 

Application Server는 엄밀히 말하면 Web Server와 Web Application Server를 포함하는 상위 개념이라고 할 수 있다.


# 웹서버(Web Server)
---

![Untitled](/assets/img/2022-06-18-web220618/Untitled 3.png)

- Web Server 는 HTTP 프로토콜을 주로 처리하는 서버이다. 즉, Web Server는 Application Server에 포함된다. 
- HTTP Request를 받아 HTTP Response를 주며, Request를 처리하기 위해 Static HTML, Image 또는 JSON 등을 이용한다. JSP, 서블릿, ASP 등이 이용되어 요청에 대한 단순 응답을 반환하는 간단한 구조를 갖는다. 인터넷 발달 초기, 단순히 인터넷을 통해 문서 조회만 가능하던 시절의 HTTP 서버들은 주로 정적인 동작만 하는 Web Server 였다고 할 수 있다.

- *정적 웹 서버*
    - HTTP 서버(소프트웨어)가 있는 컴퓨터(하드웨어)로 구성되어 있음
    - 서버가 불려질 파일을 당신의 브라우저에게 전송하기 때문에, "정적"이라고 부름

- *동적 웹 서버*
    - 동적 웹 서버는 정적 웹 서버와 추가적인 소프트웨어(대부분 일반적인 애플리케이션 서버와 데이터베이스)로 구성되어 있음
    - 애플리케이션 서버가 HTTP 서버를 통해 당신의 브라우저에게 불려진 파일들을 전송하기 전에, 애플리케이션 서버가 업데이트하기 때문에 우리는 이것을 “동적”이라고 부름
    - 사용자가 브라우저에서 보는 최종 웹페이지들을 생성하기 위해, 애플리케이션 서버는 데이터베이스로부터 온 켄텐츠들로 이루어진 html 템플릿을 전송


# 웹 애플리케이션 서버(WAS, Web Application Server)
---

![Untitled](/assets/img/2022-06-18-web220618/Untitled.png)

- 기존에 TCP/UDP 등의 프로토콜이 처리하던 전자상거래, 파일 공유 등의 기능들을 HTTP로 수행하려다 보니 나타난 새로운 형태의 서버이다. 
- 인터넷 상에서 HTTP를 통해 사용자 컴퓨터나 장치에 애플리케이션을 수행해 주는 미들웨어(소프트웨어 엔진)이다.
- 웹 애플리케이션 서버는 동적 서버 콘텐츠를 수행하는 것으로 일반적인 웹 서버와 구별이 되며, 주로 데이터베이스 서버와 같이 수행이 된다.
- Web Server 위에 서버 어플리케이션을 얹은 것이다(WAS = Web Server + Web Container). 여기서 웹 컨테이너란, JSP와 Servlet을 실행시킬 수 있는 소프트웨어를 웹 컨테이너 라고 한다.

> **정적인 HTTP 데이터 처리에 특화된 Web server에 동적인 데이터를 이용하게끔 하는 container를 엮으면 WAS가 되며, WAS는 HTTP를 이용하는 Application server로 볼 수 있다. 일반적으로 위에서 언급한 Static server의 경우 WAS라고 말하기 보다는 Web server 혹은 정적 웹서버 라고 하고, HTTP 프로토콜을 사용하지 않는 TCP 서버 등은 WAS가 아닌 App server 혹은 Application server라고 표현한다.**
>

## HTTP 통신과 TCP 통신
--- 

- http는 tcp 위에서 만들어진다. 즉, 소켓을 양끝단으로 하는 tcp 레이어 위에 존재하는 프로토콜이다. http가 tcp 위에 만들어졌으니 HTTP 또한 소켓 통신을 활용한 방식이라고 볼 수 있지 않느냐에 대한 물음에 대한 답은 '그렇다'일 것이다.
- 하지만 통신에는 계층이 있다. http와 소켓은 다른 프로토콜을 가지고 있고, 엄연히 다른 계층에서 동작한다. 일반적으로 사용하는 소켓통신(tcp통신)은 4계층에서 시작하여 패킷이 생성되고, http 통신의 경우 7계층에서부터 시작하여 패킷이 생성된다.
- 따라서 4계층 관점으로 본다면 이 둘은 연결지향적 통신이 되는 것이고,7계층 관점에서 본다면 http는 비연결, socket 통신은 연결지향적이 되는 것이다.


## 웹 컨테이너 (Web Container)
---

- JSP와 서블릿을 실행시킬 수 있는 소프트웨어를 웹 컨테이너 혹은 서블릿 컨테이너라고 한다.
- 웹 서버에서 JSP를 요청하면 톰캣에서는 JSP파일을 서블릿으로 변환하여 컴파일을 수행하고, 서블릿 수행결과를 웹 서버에게 전달하게 된다.
- JSP컨테이너가 탑재 되어 있는 WAS는 JSP 페이지를 컴파일 해 동적인 페이지를 생성한다.
- Servlet 컨테이너, JSP 컨테이너, EJB 컨테이너 등의 종류가 있다. (WebLogic 등)


# Web Server와 WAS 종류
---

## apache
---

- apache는 소프트웨어 단체 이름
- 우리가 흔히 부르는 아파치서버라는 것은 이 재단에서 후원하는 오픈소스 프로젝트 커뮤니티에서 만든 http웹서버를 말한다.
- apache는 정적인 처리에 특화된 Web Server이고, 세트로 있는 tomcat은 servelet container로 정적인 데이터와 동적인 데이터 처리가 가능하지만 주로 동적인 데이터 처리를 하는 Web Application Server이다.
- 웹서버는 클라언트가 GET, POST, DELETE 등의 메소드를 이용해서 요청을 하면 그에 대한 결과를 돌려준다.
- **즉, 아파치는 웹 서버이다.**
- 다른 Web server 목록
    - Nginx
    - IIS
    - GWS

## tomcat
---

- tomcat은 흔히 WAS(Web Application Server)라고 말한다.
- WAS는 웹서버와 웹 컨테이너의 결합으로 다양한 기능을 컨테이너에 구현하여 다양한 역할을 수행할 수 있는 서버를 말한다.
- 클라이언트의 요청이 있을 때 내부의 프로그램을 통해 결과를 만들어내고 이것을 다시 클라이언트에 전달해주는 역할을 하는 것이 바로 웹 컨테이너이다.
- **앞에서 본 아파치 웹 서버와 차이는 이 컨테이너 기능이 가능하냐의 차이가 가장 크다.**
- 다른 WAS 목록
    - Weblogic
    - JBoss
    - Jeus

# Web Server와 WAS 비교
---

- Web Container의 유무로 Web Server와 WAS를 나눌수 있음
- Web Server는 HTML 문서 같은 정적 컨텐츠를 처리 (HTTP 프로토콜을 통해 읽힐 수 있는 문서)
- WAS는 asp, php, jsp 등 개발 언어를 읽고 처리하여 동적 컨텐츠, 웹 응용 프로그램 서비스를 처리

## 차이점
---

- 목적이 다르다.
- 웹 서버는 정적인 데이터를 처리하는 서버이다. 이미지나 단순 html파일과 같은 리소스를 제공하는 서버를 웹 서버를 통하면 WAS를 이용하는 것보다 빠르고 안정적이다.
- WAS는 동적인 데이터를 처리하는 서버이다. DB와 연결되어 데이터를 주고 받거나 프로그램으로 데이터 조작이 필요한 경우에는 WAS를 활용해야 한다.
- 우리가 만드는 웹페이지는 정적 컨텐츠와 동적 컨텐츠를 함께 노출하게 한다. WAS가 정적 데이터를 처리하게 되면, 동적 컨텐츠의 처리가 지연이 될 것이고 이로 인한 페이지 노출시간이 늘어나게 된다. WAS는 동적 처리에 최적화 되어 있는 서비스이기 때문에 처리 속도를 위해, 정적처리는 웹 서버에서 처리를 하고, 동적 컨텐츠는 WAS에서 처리하게 된다.
- 사용자가 클라이언트(브라우저)에 요청을 하게 되면 이를 웹 서버에서 반응하여 WAS의 처리를 거쳐 웹 페이지로 다시 웹 서버에서 클라이언트(브라우저)에 응답 메시지를 주는 것이다.

## Web Server와 WAS를 분리하는 이유
---

1. 기능을 분리하여 서버의 부하방지
2. 물리적으로 분리하여 보안강화
3. 여러대의 WAS를 연결 가능(로드밸런싱의 역할 및 fail over, fail back 처리에 유리)
4. 여러 웹 어플리케이션을 서비스 가능(java서버, c#서버, php서버 등 하나의 웹서비스를 통해 서비스 가능)


# Web Service Architecture
---

## Web Server와 WAS 구조 종류
---

1. Client -> Web server -> DB

2. Client -> WAS -> DB

3. Client -> Web Server -> WAS -> DB

## 동작 순서
---

1. 사용자가 url을 통해 WEB 서버를 호출하고 요청사항을 객체에 담아전송

2. Web Server는 요청 객체를 받아 바로 처리하거나 WAS로 객체 전달

3. WAS는 요청에 대한 내용과 요청 객체를 받아 적절하게 처리
- 요청과 관련된 Servlet을 메모리에 올림
- web.xml을 참조하여 해당 Servlet에 대한 Thread를 생성
- HttpServletRequest와 HttpServletResponse 객체를 생성하여 Servlet에 전달
- Thread는 Servlet의 service()메서드를 호출
- service()메서드는 요청에 맞게 doGet() 또는 doPost()메서드를 호출
- doGet() 또는 doPost()메서드는 인자에 맞게 생성된 적절한 동적 페이지를 Response 객체에 담아 WAS에 전달

4. WAS는 처리후 결과를 응답 객체에 담아 Web Server로 회신

5. Web Server는 응답 객체를 다시 사용자에게 회신

6. 사용자의 브라우저는 Web Server가 보내준 코드를 해석해 화면을 구성하여 출력