---
title: (Network) Protocol Data Unit (PDU)
date: 2022-07-12 19:30 +0900
lastmod: 2022-07-12 19:30 +0900
categories: [Network]
tags: [Network, PDU]
mermaid: true
math: true
---
![Untitled](/assets/img/2022-07-12-network220712/Untitled.png)

# **프로토콜 데이터 단위**

---

- **데이터 통신에서 상위 계층이 전달한 데이터에 붙이는 제어정보를 뜻한다.**
- 데이터 자체는 동일하지만 각 레이어를 거치면서 헤더 정보가 추가되면서 이름이 달라진다.

![Untitled](/assets/img/2022-07-12-network220712/Untitled%201.png)

**사용자는 `Data` 라고 부르고,** 

**TCP는 `Segment` 라고 부르고,**

**IP는 `Packet` 이라고 부르고,**

**데이터링크는 `Frame`,**

**컴퓨터 하드웨어는 그것을 `Bit` 로 연산하고 다루게 되는 것**

## 세그먼트(L4 **전송 계층)**

---

- 상위 계층에서 **데이터**를 전달받은 전송계층에서는 아래의 정보들를 추가해 그룹화 한다. 이때부터 데이터는 데이터가 아니라, **세그먼트**라고 불리는 것이다.
- 발신지 포트 : 발신하는 application의 포트
- 목적지 포트 : 수신해야 할 application의 포트
- 순서 번호 : 순차적 전송할 경우 순서를 붙이며, 순서가 어긋나면 목적지 프로토콜이 이를 바로 잡는다.
- 오류검출코드 : 발신지와 목적지 프로토콜은 **세그먼트**를 연산하여 오류 검출 코드를 각각 만든다. 만약 발신지에서 전송한 세그먼트에 포함된 오류 검출 코드와 목적지에서 만든 오류 검출 코드가 다르다면 전송되는 과정에서 오류가 발생한 것이다. 이 경우, 수신측은 그 세그먼트를 폐기하고 복구 절차를 밟는다. 오류검출코드는 **체크섬**, **프레임 체크 시퀀스**라고도 부른다.

## **패킷 또는 데이터그램(L3 네트워크 계층)**

---

- 전송 계층으로 부터 전달받은 **세그먼트**는 네트워크 계층의 정보를 포함해 **패킷**이라고 불리게 된다.
- 발신지 컴퓨터 주소(Destination IP) : 패킷의 발신자 주소
- 목적지 컴퓨터 주소(Source IP) : 패킷의 수신자 주소

## 프레임(L2 데이터링크 계층)

---

- 데이터 링크 레이어
    - 네트워크 레이어로부터 패킷을 받아들여 네트워크 미디어에 제공하는 역할을 수행
    - 데이터 링크 레이어는 프레임의 각 패킷을 캡슐화하고 프레임의 헤더는 송신지 또는 수신지 호스트의 하드웨어 어드레스를 선택
    - 만일 장비가 원격 네트워크 상에 있으면 프레임을 라우터로 전송하여 인터네트워크를 통해 라우팅이 행해짐
    - 수신지 네트워크에 도착하면 새로운 프레임을 이용하여 패킷이 수신지 호스트에 도달하게 됨
    - **이더넷 프레임 구조**
        
        ![Untitled](/assets/img/2022-07-12-network220712/Untitled%202.png)
        
        - 이더넷 프레임은 표준인 **IEEE 802.3** 프레임과 Ethernet II라 불리는 **DIX 2.0**으로 나뉜다. 실제로는 표준이 아닌 Ethernet II 프레임 포맷을 대부분 사용
        - **각 필드의 개념**
            - Preamble
                - 송신자와 수신자의 동기화를 위해 사용된다. 10101010으로 된 7개의 비트열 전달(56비트)
            - SFD(Start of Frame Delimiter)
                - 802.3 프레임의 경우에만 있다. Preamble의 끝을 표시해주는 10101011의 8비트로 구성. 이더넷 패킷의 첫 번째 필드이자 이더넷 프레임의 시작을 알려주는 역할을 한다.
                - 자신 뒤로 오는 프레임의 내용이 곧 시작된다는 것을 알리는 역할이기도 하다. SFD는 Preamble의 비트 패턴과 실제 프레임의 시작 신호 전달을 위해 디자인 되었다.
                - ***Preamble과 SFD는 물리계층 헤더이기 때문에 MAC Frame에 포함되지 않는다. 그래서 와이어샤크에서 보이지 않는 것.***
            - MAC dst, src
                - 프레임은 출발지와 목적지의 MAC주소를 담고 있다.
                - 6바이트 = 48비트. 앞의 24비트는 제조사 번호(OUI)고 뒤 24비트는 해당 업체의 랜 카드 정보(일련번호)를 담고 있다.
            - EtherType / Length
                - 2바이트로 구성 되어 있으며 데이터에 내제된 네트워크 프로토콜 타입을 식별해주는 역할을 한다.
                - Type값이 0x0600 이상이면 DIX 2.0 Type이고 미만이면 IEEE 802.3 Type이다.
                - Length는 수납되는 LLC(Logical Link Control) 프레임 길이를 나타낸다.
            - Data / Payload
                - Payload의 최소값은 46바이트다. 46바이트가 안되면 padding을 한다(뒤에 0을 붙임). 따라서 최소 Ethernet Frame 사이즈는 18+46바이트인 64바이트다.
                - MTU(Maximum Transmission Unit)란 한 데이터링크에서 하나의 프레임 또는 패킷에 담아 운반 가능한 최대 크기다. 보통 기본 값은 1500바이트를 사용한다. 따라서, Ethernet Frame Header값인 14바이트와 MTU의 최대 값인 1500바이트, 그리고 FCS의 4바이트를 더한 1518바이트는 최대 Ethernet Frame 사이즈가 된다. VLAN Tag가 붙는다면, 4바이트가 더 붙어서 1522바이트가 된다.
            - FCS(Frame Check Sequence)
                - FCS는 수신된 전체 프레임에서 손상된 데이터를 탐지할 수 있는 CRC(Cyclic Redundancy Check)를 의미한다. 에러 검출을 한다고 보면 된다.
                - FCS값은 보호 된 MAC 프레임 필드의 함수로 계산된다. 출발지, 목적지 주소, length type, padding 등

## 비트(L1 물리적 계층)

---

- 물리적 레이어
    - 프레임을 네트워크 상으로 올려놓기 위해서 프레임을 디지털 신호로 전환시킴

# 인캡슐레이션(**encapsulation**

---

계층의 순서대로 헤더가 부가되어 가는 것을 캡슐화라고 한다.

![Untitled](/assets/img/2022-07-12-network220712/Untitled%203.png)

# **디 인캡슐레이션(de-encapsulation)**

---

1. 수신장비는 디지털 신호와 동기시켜 0과 1을 디지털 신호로부터 추출
2. 이때 수신장비는 프레임을 구성하여 CRC(Cyclic Redundancy Check)를 구동하며 그 결과를 프레임의 FCS 필드의 내용과 대조함
3. 만일 이것이 맞으면 패킷은 프레임으로부터 분리되고 프레임은 폐기됨. 패킷은 네트워크 레이어에서 처리되며 어드레스도 점검됨
4. 세그먼트는 트랜스포트 레이어에서 처리되며 데이터를 재구성하고 송신 스테이션에 수신한 것을 통과함
5. 그러면 이 데이터는 상위 레이어인 어플리케이션으로 넘겨짐